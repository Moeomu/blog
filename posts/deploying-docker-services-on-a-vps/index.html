<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="All services are deployed in Docker, services communicate with each other using Docker Network, Caddy reverse proxy all services, and visitors access directly through Cloudflare CDN."><title>Deploying Docker services on a VPS</title><link rel=canonical href=https://blog.moeomu.com/posts/deploying-docker-services-on-a-vps/><link rel=stylesheet href=/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css><meta property="og:title" content="Deploying Docker services on a VPS"><meta property="og:description" content="All services are deployed in Docker, services communicate with each other using Docker Network, Caddy reverse proxy all services, and visitors access directly through Cloudflare CDN."><meta property="og:url" content="https://blog.moeomu.com/posts/deploying-docker-services-on-a-vps/"><meta property="og:site_name" content="Misaka's Secrect Garden"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="Docker"><meta property="article:tag" content="Caddy"><meta property="article:tag" content="VPS"><meta property="article:published_time" content="2022-10-24T22:03:01+08:00"><meta property="article:modified_time" content="2022-10-24T22:03:01+08:00"><meta property="og:image" content="https://cdn.statically.io/gh/Misakaou/imagestorage@master/20221026/00002-2908894140.26d7gclffj8g.webp"><meta name=twitter:title content="Deploying Docker services on a VPS"><meta name=twitter:description content="All services are deployed in Docker, services communicate with each other using Docker Network, Caddy reverse proxy all services, and visitors access directly through Cloudflare CDN."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cdn.statically.io/gh/Misakaou/imagestorage@master/20221026/00002-2908894140.26d7gclffj8g.webp"><script async src=https://umami.moeomu.com/Prototype data-website-id=da63d88b-4c19-4ee6-93cc-e12bd941eb81></script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu5c4b01d6d06a4818a5284ca6e51e5ac9_24136_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>üç•</span></figure><div class=site-meta><h1 class=site-name><a href=/>Misaka's Secrect Garden</a></h1><h2 class=site-description>In the gardens embrace, a celestial sprite dances.</h2></div></header><ol class=social-menu><li><a href=https://github.com/Misakaou target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com target=_blank title=Twitter rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><li><a href=/comment/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-messages" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M21 14l-3-3h-7a1 1 0 01-1-1V4a1 1 0 011-1h9a1 1 0 011 1v10"/><path d="M14 15v2a1 1 0 01-1 1H6l-3 3V11a1 1 0 011-1h2"/></svg><span>Comment</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About</span></a></li><div class=menu-bottom-section><li id=i18n-switch><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><select name=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://blog.moeomu.com/ selected>English</option><option value=https://blog.moeomu.com/zh-cn/>‰∏≠Êñá</option></select></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#pre-introduction>Pre Introduction</a></li><li><a href=#create-docker-basic-service-framework>Create Docker basic service framework</a><ol><li><a href=#create-a-user>Create a user</a></li><li><a href=#create-a-docker-network>Create a Docker network</a></li><li><a href=#deploy-the-web-service>Deploy the web service</a></li><li><a href=#deploy-the-alist-service>Deploy the Alist service</a></li><li><a href=#deploy-whoogle-service>Deploy Whoogle service</a></li></ol></li><li><a href=#deploying-caddy>Deploying Caddy</a><ol><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#caddyfile>Caddyfile</a></li><li><a href=#deploying-caddy-with-docker>Deploying Caddy with Docker</a></li></ol></li><li><a href=#reference>Reference</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/posts/deploying-docker-services-on-a-vps/><img src=https://cdn.statically.io/gh/Misakaou/imagestorage@master/20221026/00002-2908894140.26d7gclffj8g.webp loading=lazy alt="Featured image of post Deploying Docker services on a VPS"></a></div><div class=article-details><header class=article-category><a href=/categories/softwareguide/>SoftwareGuide</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/deploying-docker-services-on-a-vps/>Deploying Docker services on a VPS</a></h2><h3 class=article-subtitle>All services are deployed in Docker, services communicate with each other using Docker Network, Caddy reverse proxy all services, and visitors access directly through Cloudflare CDN.</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Oct 24, 2022</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>4 minute read</time></div></footer><footer class=article-translations><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><div><a href=https://blog.moeomu.com/zh-cn/posts/%E5%9C%A8%E4%B8%80%E5%8F%B0vps%E4%B8%8A%E9%83%A8%E7%BD%B2docker%E6%9C%8D%E5%8A%A1/ class=link>‰∏≠Êñá</a></div></footer></div></header><section class=article-content><p>Source of this article: <a class=link href=/posts/deploying-docker-services-on-a-vps/>MoeomuBlog</a></p><h2 id=pre-introduction>Pre Introduction</h2><ul><li>There are some open source services that I really want to experience, but can not be deployed on a service like Paas, or can be deployed but can not persistently store some files. So not long ago, I bought a VPS, considering the security of the use of Docker to deploy all services, and the local reverse proxy using Caddy, and Caddy through the Cloudflare API automatically from the Cloudflare CDN protected DNS resolution under the acquisition and renewal of HTTPS certificates. The following is the entire process of deploying my service, if there are errors and omissions please be sure to point out.</li><li>This article will not go into detail to each command, but describe a general idea of the framework for building.</li></ul><blockquote><p>Warning: If you ignore the advice to read the official documentation in specific paragraphs of this article and execute the next commands directly, there is a high probability that you will make a mistake. At this point, you can go through the official documentation mentioned in that paragraph, or ask questions in the comments section of this article.</p></blockquote><h2 id=create-docker-basic-service-framework>Create Docker basic service framework</h2><h3 id=create-a-user>Create a user</h3><ol><li><p>Run the following command</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl> useradd -m mydocker
</span></span><span class=line><span class=cl> usermod -s /bin/bash mydocker
</span></span><span class=line><span class=cl> su mydocker
</span></span><span class=line><span class=cl> curl -fsSL https://get.docker.com/rootless <span class=p>|</span> sh
</span></span></code></pre></td></tr></table></div></div></li><li><p>Follow Docker&rsquo;s official <a class=link href=https://docs.docker.com/engine/security/rootless/ target=_blank rel=noopener>Run the Docker daemon as a non-root user (Rootless mode) - Docker Document</a> guide Configure the configuration items you want</p></li></ol><h3 id=create-a-docker-network>Create a Docker network</h3><ul><li><code>docker network create caddy</code></li></ul><h3 id=deploy-the-web-service>Deploy the web service</h3><h3 id=deploy-the-alist-service>Deploy the Alist service</h3><blockquote><p>Alist&rsquo;s Github open source address: <a class=link href=https://github.com/alist-org/alist target=_blank rel=noopener>alist - Github</a></p></blockquote><ul><li>Alist deployment commands<ul><li><code>-d</code> means run in the background</li><li><code>--name</code> specifies the name of this Docker service</li><li><code>-p host port:container port</code> specifies the port to bind to</li><li><code>--network=caddy</code> indicates the bound Docker Network</li><li><code>-v host path:container path</code> specifies the location of the file to be stored permanently</li><li><code>--restart=always</code> indicates that the service is down for restart.</li></ul></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>docker run -d --name<span class=o>=</span><span class=s2>&#34;alist&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -p 5244:5244 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --network<span class=o>=</span>caddy <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v <span class=nv>$HOME</span>/docker_data/alist:/opt/alist/data <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --restart<span class=o>=</span>always <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    xhofe/alist:latest
</span></span></code></pre></td></tr></table></div></div><ul><li>More Alist reference commands<ul><li>View Alist password: <code>docker exec -it alist . /alist password</code></li><li>View Alist logs: <code>docker logs -f alist</code></li></ul></li></ul><h3 id=deploy-whoogle-service>Deploy Whoogle service</h3><ul><li>Deploy the following commands, the details of which are not explained, and are the same as above</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>docker run -d --name whoogle <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -p 5000:5000 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --network<span class=o>=</span>caddy <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --restart<span class=o>=</span>always <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    benbusby/whoogle-search:latest
</span></span></code></pre></td></tr></table></div></div><h2 id=deploying-caddy>Deploying Caddy</h2><h3 id=prerequisites>Prerequisites</h3><p>Before deploying the Caddy service using Docker, you need to create the required Caddyfile configuration file for the Caddy service to use for automatic configuration.</p><h3 id=caddyfile>Caddyfile</h3><ol><li>Create the permanent storage location: <code>mkdir -p $HOME/docker_data/caddy/</code></li><li>Create and edit the Caddyfile file: <code>vim $HOME/docker_data/caddy/Caddyfile</code></li></ol><blockquote><p>Caddyfile</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Caddyfile data-lang=Caddyfile><span class=line><span class=cl><span class=n>(site_config)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>tls</span> <span class=s>me_tls@example.com</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>dns</span> <span class=s>cloudflare</span> <span class=se>{env.CLOUDFLARE_API_TOKEN}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>    # more config
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>reverse_proxy</span> <span class=se>{args.0}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gh>drive.example.com</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>import</span> <span class=vm>site_config</span> <span class=k>alist:5244</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gh>search.example.com</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>import</span> <span class=vm>site_config</span> <span class=k>whoogle:5000</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Additional note: The reason why <code>alist:5244</code> and <code>whoogle:5000</code> work and are resolved properly is that all three containers exist in the same Docker Network, so they can be resolved by container name.</p></blockquote><h3 id=deploying-caddy-with-docker>Deploying Caddy with Docker</h3><ul><li>The deployment command is as follows, the details of the command are not explained, it is the same as above</li><li>The following special note is needed<ul><li><code>your_cloudflare_login_email@example.com</code> replaced with your cloudflare account email</li><li><code>your_cloudflare_api_token</code> is replaced with your cloudflare api token, you can follow <a class=link href=https://developers.cloudflare.com/fundamentals/api/get-started/create-token/ target=_blank rel=noopener>Create an API token - Cloudflare Docs</a> guide to get your api token, note that when creating it here you must select <code>Zone / DNS / Edit</code> and <code>Zone / Zone / Read</code> permissions</li></ul></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>docker run -d --name<span class=o>=</span><span class=s2>&#34;caddy&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -p 443:443 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --network<span class=o>=</span>caddy <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v <span class=nv>$HOME</span>/docker_data/caddy/Caddyfile:/etc/caddy/Caddyfile <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v <span class=nv>$HOME</span>/docker_data/caddy/data:/data <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v <span class=nv>$HOME</span>/docker_data/caddy/config:/config <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -e <span class=nv>CLOUDFLARE_EMAIL</span><span class=o>=</span>your_cloudflare_login_email@example.com <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -e <span class=nv>CLOUDFLARE_API_TOKEN</span><span class=o>=</span>your_cloudflare_api_token <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -e <span class=nv>ACME_AGREE</span><span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --restart<span class=o>=</span>always <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    slothcroissant/caddy-cloudflaredns:latest
</span></span></code></pre></td></tr></table></div></div><h2 id=reference>Reference</h2><ul><li>Run the Docker daemon as a non-root user (Rootless mode). (2022, September 22). Docker Documentation. <a class=link href=https://docs.docker.com/engine/security/rootless/ target=_blank rel=noopener>https://docs.docker.com/engine/security/rootless/</a></li><li>Docker Hub. (n.d.). Hub.docker.com. Retrieved October 24, 2022, from <a class=link href=https://hub.docker.com/r/slothcroissant/caddy-cloudflaredns target=_blank rel=noopener>https://hub.docker.com/r/slothcroissant/caddy-cloudflaredns</a></li><li>Unrecognized directive: dns. (2020, May 14). Caddy Community. <a class=link href=https://caddy.community/t/unrecognized-directive-dns/8149/9 target=_blank rel=noopener>https://caddy.community/t/unrecognized-directive-dns/8149/9</a></li><li>Server, C. W. (n.d.). Caddyfile Concepts - Caddy Documentation. Caddyserver.com. Retrieved October 24, 2022, from <a class=link href=https://caddyserver.com/docs/caddyfile/concepts target=_blank rel=noopener>https://caddyserver.com/docs/caddyfile/concepts</a></li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/docker/>Docker</a>
<a href=/tags/caddy/>Caddy</a>
<a href=/tags/vps/>VPS</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/posts/installing-archlinux-on-asus-rog-strix-scar-g532/><div class=article-image><img src=https://cdn.statically.io/gh/Misakaou/imagestorage@master/20221026/00002-1464201810-install-system,-webpage-head-image,-beautiful,-ArchLinux.6mm7o4tdu64g.webp loading=lazy data-key data-hash=https://cdn.statically.io/gh/Misakaou/imagestorage@master/20221026/00002-1464201810-install-system,-webpage-head-image,-beautiful,-ArchLinux.6mm7o4tdu64g.webp></div><div class=article-details><h2 class=article-title>Installing ArchLinux on ASUS ROG Strix Scar G532</h2></div></a></article><article class=has-image><a href=/posts/problem-summary-of-installing-ubuntu-on-asusstrixscarg532/><div class=article-image><img src=https://cdn.statically.io/gh/Misakaou/imagestorage@master/20221020/1880882405-install-Problem,-Ubuntu,-webpage-head-image.g4gmdlq05jc.webp loading=lazy data-key data-hash=https://cdn.statically.io/gh/Misakaou/imagestorage@master/20221020/1880882405-install-Problem,-Ubuntu,-webpage-head-image.g4gmdlq05jc.webp></div><div class=article-details><h2 class=article-title>Problem summary of installing Ubuntu on AsusStrixScarG532</h2></div></a></article><article><a href=/posts/safer-use-of-pgp/><div class=article-details><h2 class=article-title>Safer use of PGP</h2></div></a></article><article><a href=/posts/oh-my-zsh-git-command-shortcuts/><div class=article-details><h2 class=article-title>Oh My Zsh Git Command Shortcuts</h2></div></a></article><article><a href=/posts/problems-encountered-in-installing-arch-on-roglaptop/><div class=article-details><h2 class=article-title>Problems Encountered In Installing Arch on ROGLaptop</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo=Moeomu/blog data-repo-id=R_kgDOHHJl4A data-category=Announcements data-category-id=DIC_kwDOHHJl4M4CR7uM data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en crossorigin=anonymous async></script>
<script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark_dimmed")}})()</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2023 Misaka's Secrect Garden</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.21.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>